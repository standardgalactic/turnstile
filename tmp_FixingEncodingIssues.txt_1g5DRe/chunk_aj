)
as
f:
            f.write(text)
print
(
f"Extracted text saved to:
{output_file}
")
except
Exception
as
e:
print
(
f"Error saving
{output_file}
:
{e}
")
def
process_file
(
file_path
):
"""Detect type and extract/save text accordingly."""
if
not
os.path.isfile(file_path):
print
(
f"File not found:
{file_path}
")
return
file_lower = file_path.lower()
if
file_lower.endswith(
".pdf"
):
print
(
f"Processing PDF:
{file_path}
")
        text = extract_text_from_pdf(file_path)
elif
file_lower.endswith(
".epub"
):
print
(
f"Processing EPUB:
{file_path}
")
        text = extract_text_from_epub(file_path)
elif
file_lower.endswith(
".mhtml"
)
or
file_lower.endswith(
".mht"
):
print
(
f"Processing MHTML:
{file_path}
")
        text = extract_text_from_mhtml(file_path)
else
:
print
(
f"Unsupported file type:
{file_path}
")
return
if
text.strip():
        save_text(text, file_path)
else
:
print
(
f"Warning: No text extracted from
{file_path}
")
def
process_directory
(
directory
):
"""Process all supported file types in the directory."""
for
filename
in
os.listdir(directory):
if
filename.lower().endswith((
